(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b66db"],{"1cb5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("a-form",{attrs:{layout:"horizontal"}},[a("div",[a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"网关名称",labelCol:{span:5},wrapperCol:{span:15,offset:1}}},[a("a-input",{attrs:{placeholder:"请输入",allowClear:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryDevice()}},model:{value:e.form.deviceName,callback:function(t){e.$set(e.form,"deviceName",t)},expression:"form.deviceName"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"启用/停用",labelCol:{span:5},wrapperCol:{span:15,offset:1}}},[a("a-select",{attrs:{placeholder:"请选择"},model:{value:e.form.enableFlag,callback:function(t){e.$set(e.form,"enableFlag",t)},expression:"form.enableFlag"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("启用")]),a("a-select-option",{attrs:{value:"0"}},[e._v("停用")])],1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"激活状态",labelCol:{span:5},wrapperCol:{span:15,offset:1}}},[a("a-select",{attrs:{placeholder:"请选择"},model:{value:e.form.activatedFlag,callback:function(t){e.$set(e.form,"activatedFlag",t)},expression:"form.activatedFlag"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("激活")]),a("a-select-option",{attrs:{value:"0"}},[e._v("未激活")])],1)],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"在线状态",labelCol:{span:5},wrapperCol:{span:15,offset:1}}},[a("a-select",{attrs:{placeholder:"请选择"},model:{value:e.form.onlineFlag,callback:function(t){e.$set(e.form,"onlineFlag",t)},expression:"form.onlineFlag"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("在线")]),a("a-select-option",{attrs:{value:"0"}},[e._v("离线")])],1)],1)],1)],1),a("span",{staticStyle:{float:"left","margin-bottom":"15px"}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.queryDevice()}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)],1)]),a("div",{staticStyle:{"margin-top":"35px"}},[a("a-table",{attrs:{rowKey:function(e){return e.id},columns:e.dataColumns,dataSource:e.dataSource,pagination:!1},scopedSlots:e._u([{key:"enableFlag",fn:function(t,n){return a("span",{},[a("a-switch",{attrs:{checked:1==t},on:{change:function(t){return e.onChangeSwitch(n)}}})],1)}},{key:"activatedFlag",fn:function(t){return a("span",{},[a("p",{key:t},[e._v(e._s(1==t?"激活":"未激活"))])])}},{key:"onlineFlag",fn:function(t){return a("span",{},[a("p",{key:t},[e._v(e._s(1==t?"在线":"离线"))])])}},{key:"action",fn:function(t,n){return[a("div",{staticClass:"editable-row-operations"},[a("a",{style:{marginRight:"8px"},on:{click:function(){return e.tosubDevice(n)}}},[e._v("子设备")]),a("a",{style:{marginRight:"8px"},on:{click:function(){return e.toDriveConf(n)}}},[e._v("驱动配置")]),a("a",{style:{marginRight:"8px"},on:{click:function(){return e.releaseConf(n)}}},[e._v("发布配置")]),a("a",{style:{marginRight:"8px"},on:{click:function(){return e.send(n)}}},[e._v("下发配置及固件")]),a("a",{style:{marginRight:"8px"},on:{click:function(){return e.deleteRecord(n)}}},[e._v("删除")]),a("a",{on:{click:function(){return delete n.key}}},[e._v("重启")])])]}}])}),a("a-pagination",{ref:"gridPager",staticStyle:{float:"right","margin-top":"10px"},attrs:{"show-total":function(e){return"总数："+e+" 条"},showSizeChanger:"",showQuickJumper:"",total:e.total,defaultPageSize:10,current:e.pageNumber},on:{change:e.changePage}})],1)],1),e.showJson?a("a-modal",{attrs:{title:"发布配置",width:800,visible:e.showJson,okText:"发布新配置"},on:{ok:e.ok,cancel:e.cancel}},[a("publish-conf",{ref:"parentForm",attrs:{paramJson:e.paramJson}})],1):e._e()],1)},o=[],i=a("dde5"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h3",[e._v("发布时间："+e._s(e.publishTime))]),a("a-card",[a("pre",[a("code",{attrs:{id:"json"}})])])],1)},s=[],l={props:["paramJson"],data:function(){return{publishTime:""}},mounted:function(){this.queryConf()},methods:{queryConf:function(){var e=this;i["a"].releaseConf({id:this.paramJson.deviceId}).then((function(t){var a=t.data;if(a.serviceSuccess){e.publishTime=a.data.result.publishTime;var n=document.querySelector("#json"),o=JSON.parse(a.data.result.confJson);n.textContent=JSON.stringify(o,null,"  ")}}))},generateNewConf:function(){var e=this;i["a"].generateNewConf({id:this.paramJson.deviceId}).then((function(t){var a=t.data;if(a.serviceSuccess){e.publishTime=a.data.result.publishTime;var n=document.querySelector("#json"),o=JSON.parse(a.data.result.confJson);n.textContent=JSON.stringify(o,null,"  ")}}))}}},c=l,u=a("0c7c"),d=Object(u["a"])(c,r,s,!1,null,"47789208",null),p=d.exports,f=[{title:"网关名称",dataIndex:"deviceName",key:"deviceName",overflowTooltip:!0},{title:"设备ID",dataIndex:"deviceIdentify",key:"deviceIdentify",overflowTooltip:!0},{title:"启用/停用",dataIndex:"enableFlag",scopedSlots:{customRender:"enableFlag"}},{title:"激活状态",dataIndex:"activatedFlag",scopedSlots:{customRender:"activatedFlag"}},{title:"在线状态",dataIndex:"onlineFlag",scopedSlots:{customRender:"onlineFlag"}},{title:"启动次数",dataIndex:"startCount",scopedSlots:{customRender:"startCount"}},{title:"工作时长",dataIndex:"workLength",scopedSlots:{customRender:"workLength"}},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],m={components:{publishConf:p},name:"gatewayMg",data:function(){return{form:{},dataSource:[],dataColumns:f,total:0,pageNumber:1,pageSize:10,showJson:!1,paramJson:{}}},mounted:function(){this.queryDevice()},methods:{ok:function(){this.$refs.parentForm.generateNewConf()},cancel:function(){this.showJson=!1},resetForm:function(){this.form={}},queryDevice:function(){var e=this,t=this.form;t.pageSize=this.pageSize,t.pageNumber=this.pageNumber,t.nodeType="2",i["a"].queryDevice(t).then((function(t){var a=t.data;console.log(a),a.serviceSuccess&&(e.dataSource=a.data.pageBean.list,e.total=a.data.pageBean.total>0?a.data.pageBean.total:e.total)}))},onChangeSwitch:function(){},changePage:function(e,t){this.pageNumber=e,this.pageSize=t,this.queryDevice()},tosubDevice:function(e){this.$router.push({path:"/device/deviceMg/subDeviceList",query:{id:e.id,name:e.deviceName}})},toDriveConf:function(e){this.$router.push({path:"/device/deviceMg/driveConfList",query:{id:e.id,name:e.deviceName}})},releaseConf:function(e){this.showJson=!0,this.paramJson.deviceId=e.id},send:function(e){this.$router.push({path:"/device/deviceMg/deliverConf",query:{id:e.id}})},deleteRecord:function(e){var t=this;i["a"].deleteDevice({id:e.id}).then((function(e){var a=e.data;a.serviceSuccess?(t.$message.success("删除成功"),t.changePage(1,10)):t.$message.success("删除失败")}))}}},v=m,h=Object(u["a"])(v,n,o,!1,null,"53641e84",null);t["default"]=h.exports}}]);