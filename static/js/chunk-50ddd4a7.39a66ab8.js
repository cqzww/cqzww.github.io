(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50ddd4a7"],{1378:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},a=[],c=(n("99af"),n("c975"),n("d81d"),n("5530")),i=n("93d6"),s=n("b775"),o=n("89a5"),d=n("2f62"),u=n("37c9"),l={name:"Login",data:function(){return{logging:!1,error:"",form:this.$form.createForm(this),userCenterUrl:"https://gateway-test.tq-service.com/oauth/login.html?redirectUrl="+window.location.href}},computed:{systemName:function(){return this.$store.state.setting.systemName}},created:function(){this.checkLogin()},methods:Object(c["a"])(Object(c["a"])({},Object(d["c"])("account",["setUser","setPermissions","setRoles","setUserAvatarImg"])),{},{checkLogin:function(){var t=Object(s["b"])();t?this.callBackHandler():window.location.href=this.userCenterUrl},callBackHandler:function(){var t=this;this.logging=!1,Object(i["c"])({}).then((function(e){var n=e.data,r=n.data.user;t.setUser(r),t.getUserAvatar(r.userId);var a=r.permissions,c=r.roles;console.log("当前按钮权限",a),t.setPermissions(a),t.setRoles(c);var i=a.map((function(t){return t.id}));t.getMenuConfig(i)})).catch((function(t){}))},getMenuConfig:function(t){var e=this,n=u["a"],r="051a84d5db4e48df817e4c247f9b9e77";Object(i["a"])({serviceId:r}).then((function(r){var a=r.data;if(a.data.menus&&a.data.menus.children&&a.data.menus.children.length>0){var c=a.data.menus.children[0],i=e.resolveAuthority(c.children,t)||[];n.children=n.children.concat(i)}Object(o["d"])([n]),console.log("当前菜单",n),e.$router.push("/workplace")}))},resolveAuthority:function(t,e){var n=this,r=t;return r=r.map((function(t){return t.children&&t.children.length>0?Object(c["a"])(Object(c["a"])({},t),{},{children:n.resolveAuthority(t.children,e)}):e.indexOf(t.id)>-1?Object(c["a"])(Object(c["a"])({},t),{},{authority:{permission:t.id}}):t})),r},getUserAvatar:function(t){var e=this;Object(i["b"])({userId:t}).then((function(t){var n=t.data;n.data&&n.data.portrait&&e.setUserAvatarImg(n.data.portrait)}))}})},h=l,f=(n("cd2b"),n("0c7c")),m=Object(f["a"])(h,r,a,!1,null,"e88a7344",null),g=m.exports;e["default"]=g},"78f9":function(t,e,n){},cd2b:function(t,e,n){"use strict";var r=n("78f9"),a=n.n(r);a.a}}]);