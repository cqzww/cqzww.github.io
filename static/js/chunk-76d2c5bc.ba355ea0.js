(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76d2c5bc","chunk-2d237e94"],{"3cb6":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("a-tabs",{on:{change:e.callback},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[a("a-tab-pane",{key:"1",attrs:{tab:"产品信息"}},[a("a-form",{attrs:{form:e.form,layout:"horizontal"}},[a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"产品名称",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["productName",{rules:[{required:!0,message:"请输入产品名称"}]}],expression:"[\n                    'productName',\n                    {\n                      rules: [{ required: true, message: '请输入产品名称' }],\n                    },\n                  ]"}],attrs:{disabled:"",placeholder:"请输入"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"产品分组",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["productGroup",{rules:[{required:!0,message:"请选择产品分组"}]}],expression:"[\n                    'productGroup',\n                    {\n                      rules: [{ required: true, message: '请选择产品分组' }],\n                    },\n                  ]"}],attrs:{disabled:"",placeholder:"请选择"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("产品分组1")]),a("a-select-option",{attrs:{value:"2"}},[e._v("产品分组2")]),a("a-select-option",{attrs:{value:"3"}},[e._v("产品分组3")])],1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"节点类型",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["nodeType",{rules:[{required:!0,message:"请选择节点类型"}]}],expression:"[\n                    'nodeType',\n                    {\n                      rules: [{ required: true, message: '请选择节点类型' }],\n                    },\n                  ]"}],attrs:{"button-style":"solid",disabled:""},on:{change:e.onNodeChange}},[a("a-radio-button",{attrs:{value:"1"}},[e._v(" 直连设备 ")]),a("a-radio-button",{attrs:{value:"2"}},[e._v(" 网关设备 ")]),a("a-radio-button",{attrs:{value:"3"}},[e._v(" 网关子设备 ")])],1)],1)],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:e.showGate,expression:"showGate"}]},[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"网关类型",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["gatewayType",{rules:[{required:e.showGate,message:"请选择网关类型"}]}],expression:"[\n                    'gatewayType',\n                    {\n                      rules: [{ required: showGate, message: '请选择网关类型' }],\n                    },\n                  ]"}],attrs:{disabled:""}},[e._l(e.CollectionData("GATEWAYTYPE"),(function(t,o){return[a("a-radio",{key:o,attrs:{value:t.value}},[e._v(e._s(t.label))])]}))],2)],1)],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:e.isSub,expression:"isSub"}]},[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"连网方式",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkWay",{rules:[{required:e.isSub,message:"请选择连网方式"}]}],expression:"[\n                    'networkWay',\n                    {\n                      rules: [{ required: isSub, message: '请选择连网方式' }],\n                    },\n                  ]"}],attrs:{disabled:"",placeholder:"请选择"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("WIFI")]),a("a-select-option",{attrs:{value:"2"}},[e._v("以太网")]),a("a-select-option",{attrs:{value:"3"}},[e._v("蜂窝（4G、5G）")]),a("a-select-option",{attrs:{value:"4"}},[e._v("LoRaWAN")]),a("a-select-option",{attrs:{value:"5"}},[e._v("其他")])],1)],1)],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:e.isSub,expression:"isSub"}]},[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"通讯协议",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["communicateProtocol",{rules:[{required:e.isSub,message:"请选择通讯协议"}]}],expression:"[\n                    'communicateProtocol',\n                    {\n                      rules: [{ required: isSub, message: '请选择通讯协议' }],\n                    },\n                  ]"}],attrs:{disabled:""}},[a("a-radio",{attrs:{value:"1"}},[e._v(" MQTT ")]),a("a-radio",{attrs:{value:"2"}},[e._v(" CoAP ")]),a("a-radio",{attrs:{value:"3"}},[e._v(" Http ")]),a("a-radio",{attrs:{value:"4"}},[e._v(" TCP ")]),a("a-radio",{attrs:{value:"5"}},[e._v(" MQ ")])],1)],1)],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:e.isSub,expression:"isSub"}]},[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"数据格式",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["dataformatType",{rules:[{required:e.isSub,message:"请选择数据格式"}]}],expression:"[\n                    'dataformatType',\n                    {\n                      rules: [{ required: isSub, message: '请选择数据格式' }],\n                    },\n                  ]"}],attrs:{disabled:""},on:{change:e.onFormatChange}},[a("a-radio",{attrs:{value:"1"}},[e._v(" 标准数据格式（tqLink JSON） ")]),a("a-radio",{attrs:{value:"2"}},[e._v(" 自定义 ")])],1)],1)],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:e.showItem,expression:"showItem"}]},[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:e.dataItemName,labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["dataformatProtocolId",{rules:[{required:e.showItem,message:"请选择"}]}],expression:"[\n                    'dataformatProtocolId',\n                    { rules: [{ required: showItem, message: '请选择' }] },\n                  ]"}],attrs:{disabled:"",placeholder:"请选择"}},e._l(e.subProtoList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"启动/停用",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol,fieldDecoratorId:"enableFlag"}},[a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["enableFlag",{valuePropName:"checked"}],expression:"['enableFlag', { valuePropName: 'checked' }]"}],attrs:{disabled:""}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"备注",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol,fieldDecoratorId:"description"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description"],expression:"['description']"}],attrs:{rows:4,placeholder:"请输入",disabled:""}})],1)],1)],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"功能管理"}},[a("prod-func-list",{ref:"parentForm",attrs:{paramJson:e.paramJson}})],1)],1)],1)],1)},r=[],s=(a("a9e3"),a("dde5")),n=a("fcab"),l={components:{ProdFuncList:n["default"]},data:function(){return{formItemLayout:{labelCol:{span:6},wrapperCol:{span:18}},form:this.$form.createForm(this,{}),dataItemName:"自定义数据格式",isSub:!0,showGate:!1,showItem:!1,proId:this.$route.query.id,paramJson:{},subProtoList:[],activeKey:this.$route.query.key}},mounted:function(){"1"===this.activeKey?this.queryProDuctInfo(this.proId):"2"===this.activeKey&&(this.paramJson.productId=this.proId)},methods:{callback:function(e){"2"===e&&(this.paramJson.productId=this.proId)},querySubdeviceList:function(){var e=this;s["a"].querySubDeviceProto({enableFlag:"1"}).then((function(t){var a=t.data;e.subProtoList=a.data.pageBean.list}))},onNodeChange:function(e){"3"==e.target.value?(this.isSub=!1,this.showItem=!0,this.dataItemName="子设备协议名称"):(this.isSub=!0,"2"==this.form.getFieldsValue().dataformatType?this.showItem=!0:this.showItem=!1,this.dataItemName="自定义数据格式")},onFormatChange:function(e){"3"!=this.form.getFieldsValue().nodeType?"2"==e.target.value?this.showItem=!0:this.showItem=!1:this.showItem=!0},queryProDuctInfo:function(e){var t=this;s["f"].queryProductInfo({id:e}).then((function(e){var a=e.data;console.log(a),a.enableFlag="1"==a.enableFlag,t.form.setFieldsValue(a),"3"===a.nodeType?(t.isSub=!1,t.showItem=!0,t.dataItemName="子设备协议名称",t.querySubdeviceList(),t.form.setFieldsValue({dataformatProtocolId:Number(a.dataformatProtocolId)})):"2"===a.nodeType&&(t.showGate=!0),"2"===a.dataformatType&&(t.showItem=!0)}))}}},i=l,u=(a("50ab"),a("0c7c")),c=Object(u["a"])(i,o,r,!1,null,"11e2bd8a",null);t["default"]=c.exports},"50ab":function(e,t,a){"use strict";var o=a("9dc4"),r=a.n(o);r.a},"9dc4":function(e,t,a){},fcab:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{staticStyle:{"padding-top":"10px"}},[a("a-row",[a("a-col",[a("span",{staticStyle:{float:"left","margin-top":"3px"}},[a("a-button",{style:{marginRight:"8px"},attrs:{type:"primary"},on:{click:function(t){return e.add()}}},[e._v("添加")]),a("a-button",{style:{marginRight:"8px"},on:{click:function(t){return e.modelPublish()}}},[e._v("物模型发布")]),a("a-button",{on:{click:function(t){return e.viewModelTsl()}}},[e._v("查看物模型")])],1)]),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"功能类型",labelCol:{span:5},wrapperCol:{span:15,offset:1}}},[a("a-select",{attrs:{placeholder:"请选择"},model:{value:e.form.funcType,callback:function(t){e.$set(e.form,"funcType",t)},expression:"form.funcType"}},[e._l(e.CollectionData("PARAMTYPE"),(function(t,o){return[a("a-select-option",{key:o,attrs:{value:t.value}},[e._v(e._s(t.label))])]}))],2)],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"功能名称",labelCol:{span:5},wrapperCol:{span:15,offset:1}}},[a("a-input",{attrs:{placeholder:"请输入",allowClear:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryFunc()}},model:{value:e.form.funcName,callback:function(t){e.$set(e.form,"funcName",t)},expression:"form.funcName"}})],1)],1),a("a-col",[a("span",{staticStyle:{float:"left","margin-top":"3px"}},[a("a-button",{style:{marginRight:"8px"},attrs:{type:"primary"},on:{click:function(t){return e.queryFunc()}}},[e._v("查询")]),a("a-button",{style:{marginRight:"8px"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)])],1)],1)]),a("a-table",{attrs:{rowKey:function(e){return e.id},columns:e.dataColumns,dataSource:e.dataSource,pagination:!1},scopedSlots:e._u([{key:"funcType",fn:function(t){return a("span",{},[e._v(" "+e._s(e.CollectionLabel("PARAMTYPE",t))+" ")])}},{key:"dataType",fn:function(t){return a("span",{},[e._v(" "+e._s(e.CollectionLabel("PARAMDATATYPE",t))+" ")])}},{key:"action",fn:function(t,o){return[a("div",{staticClass:"editable-row-operations"},[a("a",{style:{marginRight:"8px"},on:{click:function(){return e.view(o)}}},[e._v("查看")]),a("a",{style:{marginRight:"8px"},on:{click:function(){return e.edit(o)}}},[e._v("编辑")]),a("a-popconfirm",{attrs:{title:"是否确定删除该记录？","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.deleteRecord(o)}}},[a("a",{attrs:{href:"#"}},[e._v("删除")])])],1)]}}])}),a("a-pagination",{ref:"gridPager",staticStyle:{float:"right","margin-top":"10px"},attrs:{"show-total":function(e){return"总数："+e+" 条"},showSizeChanger:"",showQuickJumper:"",total:e.total,defaultPageSize:10,current:e.pageNumber},on:{change:e.changePage}}),e.showModel?a("a-modal",{attrs:{title:"发布物模型",width:800,visible:e.showModel,okText:"发布"},on:{ok:e.okPublish,cancel:e.cancelPublish}},[a("model-edit",{ref:"editForm",attrs:{editJson:e.editJson},on:{saveModel:e.saveModel}})],1):e._e(),e.showView?a("a-modal",{attrs:{title:"查看物模型",width:800,visible:e.showView,"ok-button-props":{style:{display:"none"}}},on:{cancel:e.cancelView}},[a("model-view",{ref:"viewForm",attrs:{viewJson:e.viewJson}})],1):e._e()],1)},r=[],s=a("dde5"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("pre",[a("code",{attrs:{id:"json"}})])]),a("a-form",{attrs:{form:e.form,layout:"horizontal"}},[a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"版本",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["version",{rules:[{required:!0,message:"请输入版本"}]}],expression:"[\n                      'version',\n                      { rules: [{ required: true, message: '请输入版本' }] },\n                      ]"}],attrs:{placeholder:"请输入"}})],1)],1)],1)],1)],1)},l=[],i={props:["editJson"],data:function(){return{form:this.$form.createForm(this,{}),formItemLayout:{labelCol:{span:6},wrapperCol:{span:10}},jsonStr:""}},mounted:function(){this.generateNewModel()},methods:{generateNewModel:function(){var e=this;s["d"].modelPublish({id:this.editJson.productId}).then((function(t){var a=t.data;if(a.serviceSuccess){var o=document.querySelector("#json");e.jsonStr=a.data.result.confJson;var r=JSON.parse(a.data.result.confJson);o.textContent=JSON.stringify(r,null,"  ")}}))},saveForm:function(){var e=this,t=this.form.getFieldsValue();t.id=null,t.productId=this.editJson.productId,t.confJson=this.jsonStr,this.form.validateFields((function(a){a||s["d"].saveModel(t).then((function(t){var a=t.data;console.log(a),a.serviceSuccess?(e.$message.success("发布成功"),e.$emit("saveModel")):e.$message.error("发布失败")}))}))}}},u=i,c=a("0c7c"),d=Object(c["a"])(u,n,l,!1,null,"8bc99bc2",null),m=d.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form",{attrs:{form:e.form,layout:"horizontal"}},[a("a-row",[a("a-col",{attrs:{span:16}},[a("a-form-item",{attrs:{label:"版本",labelCol:e.formItemLayout.labelCol,wrapperCol:e.formItemLayout.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["version",{rules:[{required:!0,message:"请选择版本"}]}],expression:"[\n                'version',\n                {\n                  rules: [{ required: true, message: '请选择版本' }],\n                },\n              ]"}],attrs:{placeholder:"请选择版本再查看"},on:{change:e.changeVersion}},e._l(e.versionList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.version}},[e._v(" "+e._s(t.version)+" ")])})),1)],1)],1)],1)],1),a("a-card",[a("pre",[a("code",{attrs:{id:"json"}})])])],1)},f=[],v=(a("4160"),a("159b"),{props:["viewJson"],data:function(){return{form:this.$form.createForm(this,{}),formItemLayout:{labelCol:{span:6},wrapperCol:{span:10}},versionList:[]}},mounted:function(){this.queryModel()},methods:{queryModel:function(){var e=this;s["d"].queryModel({productId:this.viewJson.productId}).then((function(t){var a=t.data;a.data.pageBean.list.forEach((function(t){e.versionList.push(t)}))}))},changeVersion:function(e){s["d"].queryModel({productId:this.viewJson.productId,version:e}).then((function(e){var t=e.data;if(t.serviceSuccess){var a=document.querySelector("#json"),o=JSON.parse(t.data.pageBean.list[0].confJson);a.textContent=JSON.stringify(o,null,"  ")}}))}}}),h=v,w=Object(c["a"])(h,p,f,!1,null,"3d1c90c4",null),b=w.exports,y=[{title:"功能类型",dataIndex:"funcType",key:"funcType",overflowTooltip:!0,scopedSlots:{customRender:"funcType"}},{title:"功能名称",dataIndex:"funcName",key:"funcName",overflowTooltip:!0},{title:"标识符",dataIndex:"funcTag",key:"funcTag",overflowTooltip:!0},{title:"数据类型",dataIndex:"dataType",scopedSlots:{customRender:"dataType"}},{title:"数据定义",dataIndex:"dataJson",scopedSlots:{customRender:"dataJson"}},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],g={components:{modelEdit:m,modelView:b},props:["paramJson"],data:function(){return{form:{},dataSource:[],dataColumns:y,total:0,pageNumber:1,pageSize:10,showModel:!1,showView:!1,editJson:{},viewJson:{}}},mounted:function(){console.log(this.paramJson.productId),this.queryFunc()},methods:{changePage:function(e,t){this.pageNumber=e,this.pageSize=t,this.queryFunc()},resetForm:function(){this.form={},this.queryFunc()},queryFunc:function(){var e=this,t=this.form;t.productId=this.paramJson.productId,s["d"].queryProductFunc(t).then((function(t){var a=t.data;a.serviceSuccess&&(e.dataSource=a.data.pageBean.list,e.total=a.data.pageBean.total>0?a.data.pageBean.total:e.total)}))},deleteRecord:function(e){var t=this;s["d"].deleteProductFunc({id:e.id,delFlag:"1"}).then((function(e){var a=e.data;a.serviceSuccess?(t.$message.success("删除成功"),t.changePage(1,10)):t.$message.success("删除失败")}))},add:function(){this.$router.push({path:"/device/produceMg/prodFuncEdit",query:{editType:"1",proId:this.paramJson.productId}})},edit:function(e){this.$router.push({path:"/device/produceMg/prodFuncEdit",query:{editType:"2",proId:this.paramJson.productId,id:e.id}})},view:function(e){this.$router.push({path:"/device/produceMg/prodFuncInfo",query:{proId:this.paramJson.productId,id:e.id}})},importData:function(){},viewModelTsl:function(){this.showView=!0,this.viewJson.productId=this.paramJson.productId},modelPublish:function(){this.showModel=!0,this.editJson.productId=this.paramJson.productId},okPublish:function(){this.$refs.editForm.saveForm()},saveModel:function(){this.showModel=!1},cancelPublish:function(){this.showModel=!1},okView:function(){},cancelView:function(){this.showView=!1}}},I=g,C=Object(c["a"])(I,o,r,!1,null,null,null);t["default"]=C.exports}}]);